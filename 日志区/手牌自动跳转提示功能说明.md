# 手牌自动跳转提示功能说明

## 功能概述
当手牌区的牌选满时，系统会自动切换到和牌区，并显示一个优雅的Toast提示信息。

## 实现细节

### 1. Toast提示系统 (新增)

#### 变量定义 (第110-113行)
```javascript
// 新增：Toast提示系统
let toastMessage = '';
let toastVisible = false;
let toastTimer = null;
```

#### Toast函数 (第2217-2254行)
```javascript
// Toast提示函数
const showToast = (message, duration = 2000) => {
  // 清除之前的定时器
  if (toastTimer) {
    clearTimeout(toastTimer);
  }
  
  toastMessage = message;
  toastVisible = true;
  render();
  
  // 自动隐藏
  toastTimer = setTimeout(() => {
    toastVisible = false;
    render();
  }, duration);
};

// 渲染Toast UI
const renderToast = () => {
  const toastContainer = document.getElementById('toast-container');
  if (!toastContainer) return;
  
  if (toastVisible && toastMessage) {
    toastContainer.innerHTML = `
      <div class="fixed top-20 left-1/2 transform -translate-x-1/2 z-50 animate-fade-in">
        <div class="bg-green-600 text-white px-6 py-3 rounded-lg shadow-2xl flex items-center gap-2 max-w-md">
          <span class="text-lg">${toastMessage}</span>
        </div>
      </div>
    `;
  } else {
    toastContainer.innerHTML = '';
  }
};
```

### 2. 自动跳转逻辑 (第2188-2202行)

```javascript
const addTile = (tile) => {
  const requiredCount = getRequiredHandTileCount();
  if (selectedTiles.length >= requiredCount) return;

  // 检查该牌是否超过4张
  if (getTileUsageCount(tile) >= 4) return;
  
  selectedTiles = [...selectedTiles, tile];
  autoAdjustRedDora(); // 自动调整红宝牌
  
  // 当手牌选满时,自动跳转到和牌区
  if (selectedTiles.length === requiredCount) {
    activeTileArea = 'win';
    showToast('✅ 手牌已满，已自动切换到和牌区');
  }
  
  render();
};
```

### 3. HTML结构修改

#### Toast容器 (第28-30行)
```html
<div id="root"></div>

<!-- Toast提示容器 -->
<div id="toast-container"></div>
```

#### CSS动画 (第9-23行)
```css
<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translate(-50%, -20px);
    }
    to {
      opacity: 1;
      transform: translate(-50%, 0);
    }
  }
  
  .animate-fade-in {
    animation: fadeIn 0.3s ease-out;
  }
</style>
```

### 4. 渲染集成 (第4011行)

```javascript
// 渲染Toast提示
renderToast();
```

## 用户体验

### 视觉效果
- ✅ **位置**: 屏幕顶部居中
- ✅ **颜色**: 绿色背景 + 白色文字
- ✅ **动画**: 0.3秒淡入 + 向下滑动
- ✅ **阴影**: 2xl级别阴影，提升层次感

### 交互行为
- ✅ **触发时机**: 手牌数量达到要求数量时
- ✅ **显示时长**: 2秒后自动消失
- ✅ **非阻塞**: 不需要用户点击确认
- ✅ **连续触发**: 多次触发会清除之前的提示

### 提示内容
```
✅ 手牌已满，已自动切换到和牌区
```

## 技术优势

1. **性能优化**
   - 使用 `setTimeout` 而非轮询
   - 通过 `requestAnimationFrame` 优化渲染
   - 清除之前的定时器避免内存泄漏

2. **用户友好**
   - 非模态提示，不打断操作流程
   - 自动消失，无需手动关闭
   - 视觉反馈明确，易于理解

3. **可扩展性**
   - `showToast(message, duration)` 可复用
   - 支持自定义消息内容
   - 支持自定义显示时长

## 使用示例

```javascript
// 显示默认时长(2秒)的提示
showToast('✅ 操作成功');

// 显示自定义时长的提示
showToast('⚠️ 请注意', 3000); // 显示3秒
```

## 相关文件
- `dmvan.html` - 主文件（已修改）

## 测试建议

1. **基本功能测试**
   - 选择手牌直到满13张
   - 观察是否自动跳转到和牌区
   - 确认Toast提示正确显示

2. **边界情况测试**
   - 有副露时(手牌数<13)
   - 有杠时(手牌数可能14/15/16张)
   - 连续快速添加牌

3. **视觉测试**
   - 确认动画流畅
   - 确认2秒后自动消失
   - 确认不影响其他界面元素

## 版本信息
- **功能**: 手牌自动跳转Toast提示
- **实现日期**: 2025年10月29日
- **修改文件**: dmvan.html
- **新增代码行数**: 约50行
