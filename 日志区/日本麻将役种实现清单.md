# 日本麻将役种实现清单

## 实现状态：2025年10月28日

---

## ✅ 已实现的役种

### 役满（13番）及双倍役满（26番）

1. ✅ **国士无双** (13番)
   - 13种幺九牌各一张+其中一种成对
   
2. ✅ **国士无双十三面待** (26番/双倍役满)
   - 13种幺九牌各一张，听13面
   
3. ✅ **四暗刻** (13番)
   - 门前，4个暗刻+1个雀头，自摸和牌
   
4. ✅ **四暗刻単騎** (26番/双倍役满)
   - 门前，4个暗刻，单骑听雀头
   
5. ✅ **字一色** (13番)
   - 全部由字牌（东南西北白发中）组成
   
6. ✅ **清老头** (13番)
   - 全部由幺九牌（1、9万筒索）组成
   
7. ✅ **天和** (13番)
   - 庄家配牌即和
   
8. ✅ **地和** (13番)
   - 闲家第一巡自摸和
   
9. ✅ **人和** (13番)
   - 闲家第一巡荣和（某些规则为满贯）
   
10. ✅ **大三元** (13番)
    - 白、发、中三种役牌都成刻子
    
11. ✅ **大四喜** (26番/双倍役满)
    - 东南西北四种风牌都成刻子
    
12. ✅ **小四喜** (13番)
    - 东南西北中三种成刻子，一种做雀头
    
13. ✅ **绿一色** (13番)
    - 只用2、3、4、6、8索和发组成
    
14. ✅ **九莲宝灯** (13番)
    - 门前，同花色1112345678999+任意一张同花色
    
15. ✅ **纯正九莲宝灯** (26番/双倍役满)
    - 1112345678999听9面

16. ⚠️ **四杠子** (13番) - 预留，需要扩展面子类型

---

### 6番

17. ✅ **清一色** (6番门前/5番副露)
    - 全部由同一花色的数牌组成

---

### 3番

18. ✅ **混一色** (3番门前/2番副露)
    - 由同一花色的数牌+字牌组成
    
19. ✅ **纯全带幺九** (3番门前/2番副露)
    - 每组面子和雀头都包含幺九牌（1、9），无字牌
    
20. ✅ **两杯口** (3番)
    - 门前，2组相同的顺子

---

### 2番

21. ✅ **七对子** (2番)
    - 7个对子
    
22. ✅ **对对和** (2番)
    - 4个刻子+1个雀头
    
23. ✅ **三暗刻** (2番)
    - 3个暗刻（门前）
    
24. ✅ **混老头** (2番)
    - 全部由幺九牌（含字牌）组成
    
25. ✅ **小三元** (2番)
    - 白发中，两种成刻子，一种做雀头
    
26. ✅ **三色同顺** (2番门前/1番副露)
    - 万筒索三种花色有相同数字的顺子
    
27. ✅ **三色同刻** (2番)
    - 万筒索同一数字的刻子各一个
    
28. ✅ **一气通贯** (2番门前/1番副露)
    - 同一花色的123、456、789
    
29. ✅ **混全带幺九** (2番门前/1番副露)
    - 每组面子和雀头都包含幺九牌（含字牌）
    
30. ✅ **双立直/二立直** (2番)
    - 第一巡即立直

31. ⚠️ **三杠子** (2番) - 预留，需要扩展面子类型

---

### 1番

32. ✅ **立直** (1番)
    - 门前听牌后宣告立直
    
33. ✅ **一发** (1番)
    - 立直后一巡内和牌（无人鸣牌）
    
34. ✅ **门前清自摸和** (1番)
    - 门前听牌，自摸和牌
    
35. ✅ **役牌** (1番/每种)
    - 白发中+场风+自风的刻子
    
36. ✅ **平和** (1番)
    - 门前，4组顺子+非役牌雀头+两面听
    
37. ✅ **一杯口** (1番)
    - 门前，1组相同的顺子
    
38. ✅ **断幺九** (1番)
    - 不含幺九牌和字牌
    
39. ✅ **海底捞月** (1番)
    - 自摸最后一张牌和牌
    
40. ✅ **河底捞鱼** (1番)
    - 荣和最后一张牌
    
41. ✅ **岭上开花** (1番)
    - 杠后自摸和牌
    
42. ✅ **抢杠** (1番)
    - 荣和别人的加杠

---

## 📊 统计

- **已完全实现**: 40个役种
- **预留待扩展**: 2个（四杠子、三杠子 - 需要杠子面子支持）
- **总计**: 42个日本麻将常见役种

---

## 🔧 技术实现要点

### 役满复合处理
- 当检测到役满（han >= 13）后立即返回，避免与普通役复合
- 字一色可与七对子复合
- 大三元、大四喜等独立判定

### 互斥关系
1. **天和、地和、人和** 互斥（只能有一个）
2. **立直、双立直** 互斥（双立直优先）
3. **海底捞月、河底捞鱼** 互斥（自摸/荣和）
4. **岭上开花、抢杠** 互斥（自摸/荣和）
5. **一杯口、两杯口** - 两杯口会自动移除一杯口

### 特殊逻辑
- **四暗刻**: 荣和非单骑 → 降为三暗刻+对对和
- **九莲宝灯**: 需要检测1112345678999形状
- **纯正九莲宝灯**: 额外检查13张手牌是否为111234567899
- **平和**: 需要4顺子+非役牌雀头+两面听
- **三暗刻**: 自摸时所有刻子都是暗刻，荣和时和了牌不算暗刻

---

## 📝 注意事项

1. **人和规则**: 在某些规则中，人和为满贯而非役满，当前实现为役满
2. **杠子支持**: 四杠子、三杠子需要扩展面子类型以支持明杠/暗杠区分
3. **流局满贯**: 未实现（四风连打等特殊流局情况）
4. **地方规则**: 未实现地方特色役种（如大车轮、天衣无缝等）

---

## ✨ 实现亮点

- ✅ 完整覆盖日本麻将标准役种
- ✅ 正确处理役满复合与互斥
- ✅ 准确判断暗刻（自摸/荣和区分）
- ✅ 支持双倍役满（国士十三面、四暗刻単騎、大四喜、纯正九莲宝灯）
- ✅ UI交互自动处理互斥关系（如天地人和、海河底等）
